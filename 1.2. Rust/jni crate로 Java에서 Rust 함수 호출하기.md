[doc](https://docs.rs/jni/latest/jni/)
JNI: Java Native Interface

우선 아무 디렉토리에서 간단하게 `HelloWorld.java` 파일을 통해 다음 클래스를 만들어주자.
```java
public class HelloWorld {
  // rust에서 호출할 함수의 signature이다.
  private static native String hello(String input);
  static { // 환경 변수인 LD_LIBRARY_PATH에서 libmylib.so를 불러온다.
    System.loadLibrary("mylib");
  }
  public static void main(String[] args) {
    String output = HelloWorld.hello("SeJin"); // rust 함수 호출
    System.out.println(output); // 결과 출력
  }
}
```
다음 명령어로 `HelloWorld.java`를 바이트 코드로 컴파일한다.
```
javac HelloWorld.java
```
그리고 다음의 명령어로 현재 경로에 `HelloWorld.java`에 대한 header 파일을 만들어준다.
```
javac -h . HelloWorld.java
```

그러면 다음과 같이 `HelloWorld.h`가 만들어질 것이다.
```c
/* DO NOT EDIT THIS FILE - it is machine generated */
#include <jni.h>
/* Header for class HelloWorld */

#ifndef _Included_HelloWorld
#define _Included_HelloWorld
#ifdef __cplusplus
extern "C" {
#endif
/*
 * Class:     HelloWorld
 * Method:    hello
 * Signature: (Ljava/lang/String;)Ljava/lang/String;
 */
JNIEXPORT jstring JNICALL Java_HelloWorld_hello
  (JNIEnv *, jclass, jstring);

#ifdef __cplusplus
}
#endif
#endif
```
이제 Rust에서 이 헤더파일에 명시된대로 그대로 함수를 만들어주면 된다.

현재 디렉토리에서 다음의 명령어로 Rust library crate를 만들어주자.
```
cargo new mylib --lib
```

`Cargo.toml` 파일을 다음과 같이 수정해주자.
```
[package]
name = "mylib"
version = "0.1.0"
edition = "2021"

[dependencies]
jni = "0.21.1"

[lib]
crate_type = ["cdylib"]
```

`lib.rs`에 다음과 같이 코드를 작성한다.
```rust
use jni::{
  objects::{JClass, JString},
  sys::jstring,
  JNIEnv,
};

#[no_mangle]
pub extern "system" fn Java_HelloWorld_hello<'local>(
  mut env: JNIEnv<'local>,
  _class: JClass<'local>,
  input: JString<'local>,
) -> jstring {
  let input: String = env
    .get_string(&input)
    .expect("Couldn't get java string!")
    .into();

  let output = env
    .new_string(format!("Hello, {}!", input))
    .expect("Couldn't create java string!");

  output.into_raw()
}
```

```
cd mylib
cargo build
```
를 하면 `mylib` 프로젝트의 `target/debug/` 디렉토리에 `libmylib.so` 파일이 생성될 것이다. 이 `debug` 디렉토리의 경로를 따서 다음의 명령어로 리눅스 환경변수 `LD_LIBRARY_PATH`에 이 경로를 현재 쉘에 추가해주자.
```
export LD_LIBRARY_PATH=/path/to/your/mylib/target/debug
```

그리고 다음 명령어를 통해 java 코드를 실행해보자.
```
cd ..
java HelloWorld
Hello, SeJin!
```
잘된다.

이를 이용하면 java에서 강력한 성능의 Rust 함수를 호출할 수 있게된다. 